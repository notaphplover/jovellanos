!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).jovellanos=e()}}(function(){return function i(s,o,u){function l(t,e){if(!o[t]){if(!s[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(f)return f(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=o[t]={exports:{}};s[t][0].call(a.exports,function(e){return l(s[t][1][e]||e)},a,a.exports,i,s,o,u)}return o[t].exports}for(var f="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TokenMap=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),s=function(){function e(){(0,a.default)(this,e),this.innerMap=new Map,this.unusedIndexes=new Array}return(0,i.default)(e,[{key:"add",value:function(e){if(0===this.unusedIndexes.length){var t=this.innerMap.size;return this.innerMap.set(t,e),t}var r=this.unusedIndexes[this.unusedIndexes.length-1];return--this.unusedIndexes.length,this.innerMap.set(r,e),r}},{key:"count",value:function(){return this.innerMap.size}},{key:"foreach",value:function(r){this.innerMap.forEach(function(e,t){r(e,t)})}},{key:"get",value:function(e){return this.innerMap.get(e)}},{key:"remove",value:function(e){return!!this.innerMap.has(e)&&(this.innerMap.delete(e),this.unusedIndexes[this.unusedIndexes.length]=e,!0)}}]),e}();r.TokenMap=s},{"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/createClass":15,"@babel/runtime/helpers/interopRequireDefault":18}],2:[function(e,t,r){"use strict";var n=e("./task/flow/task-part-begin-constraint"),a=e("./task/flow/task-part-end-constraint"),i=e("./task/flow/task-part-group-constraint"),s=e("./task/flow/task-part-time-constraint"),o=e("./task/operation/operation-manager"),u=e("./task/task-engine"),l=e("./task/task-part-when-events"),f=e("./task/task-part-when-operator"),c={task:{TASK_PART_WHEN_EVENTS:l.TASK_PART_WHEN_EVENTS,TaskEngine:u.TaskEngine,TaskPartWhenOperator:f.TaskPartWhenOperator,flow:{TaskGroupConstraint:i.TaskGroupConstraint,TaskPartBeginConstraint:n.TaskPartBeginConstraint,TaskPartEndConstraint:a.TaskPartEndConstraint,TaskTimeConstraint:s.TaskTimeConstraint},operation:{OperationManager:o.OperationManager}}};t.exports=c},{"./task/flow/task-part-begin-constraint":4,"./task/flow/task-part-end-constraint":6,"./task/flow/task-part-group-constraint":7,"./task/flow/task-part-time-constraint":8,"./task/operation/operation-manager":9,"./task/task-engine":10,"./task/task-part-when-events":11,"./task/task-part-when-operator":12}],3:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskPartWhenConstraint=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck"));r.TaskPartWhenConstraint=function e(t,r){(0,a.default)(this,e),this.after=t,this.constraintType=r}},{"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/interopRequireDefault":18}],4:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskPartBeginConstraint=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/possibleConstructorReturn")),s=n(e("@babel/runtime/helpers/getPrototypeOf")),o=n(e("@babel/runtime/helpers/inherits")),u=e("./task-part-constraint"),l=function(e){function r(e,t){return(0,a.default)(this,r),(0,i.default)(this,(0,s.default)(r).call(this,e,t,u.TASK_CONSTRAINT_TYPES.START))}return(0,o.default)(r,e),r}(u.TaskPartConstraint);r.TaskPartBeginConstraint=l},{"./task-part-constraint":5,"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/getPrototypeOf":16,"@babel/runtime/helpers/inherits":17,"@babel/runtime/helpers/interopRequireDefault":18,"@babel/runtime/helpers/possibleConstructorReturn":19}],5:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskPartConstraint=r.TASK_CONSTRAINT_TYPES=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/possibleConstructorReturn")),o=n(e("@babel/runtime/helpers/getPrototypeOf")),u=n(e("@babel/runtime/helpers/inherits")),a=e("./task-flow-when");r.TASK_CONSTRAINT_TYPES={END:"anim.end",GROUP:"group",START:"anim.start",WAIT_FOR:"wait"};var l=function(e){function a(e,t,r){var n;return(0,i.default)(this,a),(n=(0,s.default)(this,(0,o.default)(a).call(this,e,r))).alias=t,n}return(0,u.default)(a,e),a}(a.TaskPartWhenConstraint);r.TaskPartConstraint=l},{"./task-flow-when":3,"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/getPrototypeOf":16,"@babel/runtime/helpers/inherits":17,"@babel/runtime/helpers/interopRequireDefault":18,"@babel/runtime/helpers/possibleConstructorReturn":19}],6:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskPartEndConstraint=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/possibleConstructorReturn")),s=n(e("@babel/runtime/helpers/getPrototypeOf")),o=n(e("@babel/runtime/helpers/inherits")),u=e("./task-part-constraint"),l=function(e){function r(e,t){return(0,a.default)(this,r),(0,i.default)(this,(0,s.default)(r).call(this,e,t,u.TASK_CONSTRAINT_TYPES.END))}return(0,o.default)(r,e),r}(u.TaskPartConstraint);r.TaskPartEndConstraint=l},{"./task-part-constraint":5,"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/getPrototypeOf":16,"@babel/runtime/helpers/inherits":17,"@babel/runtime/helpers/interopRequireDefault":18,"@babel/runtime/helpers/possibleConstructorReturn":19}],7:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskGroupConstraint=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/possibleConstructorReturn")),o=n(e("@babel/runtime/helpers/getPrototypeOf")),u=n(e("@babel/runtime/helpers/inherits")),a=e("./task-flow-when"),l=e("./task-part-constraint"),f=function(e){function a(e,t,r){var n;return(0,i.default)(this,a),(n=(0,s.default)(this,(0,o.default)(a).call(this,e,l.TASK_CONSTRAINT_TYPES.GROUP))).constraints=t,n.operator=r,n}return(0,u.default)(a,e),a}(a.TaskPartWhenConstraint);r.TaskGroupConstraint=f},{"./task-flow-when":3,"./task-part-constraint":5,"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/getPrototypeOf":16,"@babel/runtime/helpers/inherits":17,"@babel/runtime/helpers/interopRequireDefault":18,"@babel/runtime/helpers/possibleConstructorReturn":19}],8:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskTimeConstraint=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/possibleConstructorReturn")),s=n(e("@babel/runtime/helpers/getPrototypeOf")),o=n(e("@babel/runtime/helpers/inherits")),u=e("./task-flow-when"),l=e("./task-part-constraint"),f=function(e){function n(e,t){var r;return(0,a.default)(this,n),(r=(0,i.default)(this,(0,s.default)(n).call(this,e,l.TASK_CONSTRAINT_TYPES.WAIT_FOR))).millis=t,r}return(0,o.default)(n,e),n}(u.TaskPartWhenConstraint);r.TaskTimeConstraint=f},{"./task-flow-when":3,"./task-part-constraint":5,"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/getPrototypeOf":16,"@babel/runtime/helpers/inherits":17,"@babel/runtime/helpers/interopRequireDefault":18,"@babel/runtime/helpers/possibleConstructorReturn":19}],9:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.OperationManager=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),s=e("../../collection/token-map"),o=function(){function r(e,t){(0,a.default)(this,r);var f=this;this.callFunction=function(t){if(null==t.aliases){for(var e in f.subscriptionStorage)if(f.subscriptionStorage.hasOwnProperty(e)){var r=f.subscriptionStorage[e];null!=r&&r.foreach(function(e){e(t)})}}else{var n=!0,a=!1,i=void 0;try{for(var s,o=t.aliases[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value,l=f.subscriptionStorage[u];null!=l&&l.foreach(function(e){e(t)})}}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}}},this.eventAlias=e,this.eventEmitter=t,this.subscriptionStorage={},this.eventEmitter.addListener(this.eventAlias,this.callFunction)}return(0,i.default)(r,[{key:"dispose",value:function(){this.eventEmitter.removeListener(this.eventAlias,this.callFunction)}},{key:"subscribe",value:function(e,t){return null==this.subscriptionStorage[e]&&(this.subscriptionStorage[e]=new s.TokenMap),this.subscriptionStorage[e].add(t)}},{key:"unsubscribe",value:function(e,t){return null!=this.subscriptionStorage[e]&&this.subscriptionStorage[e].remove(t)}}]),r}();r.OperationManager=o},{"../../collection/token-map":1,"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/createClass":15,"@babel/runtime/helpers/interopRequireDefault":18}],10:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.TaskEngine=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),s=e("events"),o=e("./flow/task-part-constraint"),u=e("./operation/operation-manager"),l=e("./task-part-when-events"),f=e("./task-part-when-operator"),c=function(){function e(){(0,a.default)(this,e),this.eventEmitter=new s.EventEmitter,this.partEndManager=new u.OperationManager(l.TASK_PART_WHEN_EVENTS.END,this.eventEmitter),this.partStartManager=new u.OperationManager(l.TASK_PART_WHEN_EVENTS.START,this.eventEmitter)}return(0,i.default)(e,[{key:"getPartEndListenerAccess",value:function(){var r=this;return{subscribe:function(e,t){return r.partEndManager.subscribe(e,t)},unsubscribe:function(e,t){return r.partEndManager.unsubscribe(e,t)}}}},{key:"getPartStartListenerAccess",value:function(){var r=this;return{subscribe:function(e,t){return r.partStartManager.subscribe(e,t)},unsubscribe:function(e,t){return r.partStartManager.unsubscribe(e,t)}}}},{key:"handle",value:function(e){if(null==e)throw new Error("It's required a task flow.");if(null==e.parts)throw new Error("It's required a task flow with parts.");this.currentTask=e;for(var t=new Array(e.parts.length),r=0;r<e.parts.length;++r)t[r]=this.handleTaskPart(e.parts[r]);return t}},{key:"handleTaskPart",value:function(r){var n=this;return new Promise(function(e,t){n.handleTaskPartWhen(r.when).then(function(){n.eventEmitter.emit(l.TASK_PART_WHEN_EVENTS.START,{aliases:[r.alias],part:r}),n.performTask(r).then(function(){n.eventEmitter.emit(l.TASK_PART_WHEN_EVENTS.END,{aliases:[r.alias],part:r}),e()})}).catch(function(e){t(e)})})}},{key:"handleTaskPartWhen",value:function(r){var n=this;return new Promise(function(e,t){if(null==r)e();else switch(r.constraintType){case o.TASK_CONSTRAINT_TYPES.START:n.handleTaskPartWhenPartBegins(r).then(e);break;case o.TASK_CONSTRAINT_TYPES.END:n.handleTaskPartWhenPartEnds(r).then(e);break;case o.TASK_CONSTRAINT_TYPES.GROUP:n.handleTaskPartWhenPartGroup(r).then(e);break;case o.TASK_CONSTRAINT_TYPES.WAIT_FOR:n.handleTaskPartWhenWaitFor(r).then(e);break;default:t(new Error("Unexpected when entity type."))}})}},{key:"handleTaskPartWhenPartBegins",value:function(n){var a=this;return new Promise(function(e,t){var r=a.partStartManager.subscribe(n.alias,function(){a.partStartManager.unsubscribe(n.alias,r),null==n.after?e():a.handleTaskPartWhen(n.after).then(e)})})}},{key:"handleTaskPartWhenPartEnds",value:function(n){var a=this;return new Promise(function(e,t){var r=a.partEndManager.subscribe(n.alias,function(){a.partEndManager.unsubscribe(n.alias,r),null==n.after?e():a.handleTaskPartWhen(n.after).then(e)})})}},{key:"handleTaskPartWhenPartGroup",value:function(a){var i=this;return new Promise(function(e,t){for(var r=new Array(a.constraints.length),n=0;n<a.constraints.length;++n)r[n]=new Promise(function(e,t){i.handleTaskPartWhen(a.constraints[n]).then(e)});f.TaskPartWhenOperator.AND===a.operator?Promise.all(r).then(function(){e()}):f.TaskPartWhenOperator.OR===a.operator?Promise.race(r).then(function(){e()}):t("Unexpected operator.")})}},{key:"handleTaskPartWhenWaitFor",value:function(r){var n=this;return new Promise(function(e,t){setTimeout(function(){null==r.after?e():n.handleTaskPartWhen(r.after).then(e)},r.millis)})}}]),e}();r.TaskEngine=c},{"./flow/task-part-constraint":5,"./operation/operation-manager":9,"./task-part-when-events":11,"./task-part-when-operator":12,"@babel/runtime/helpers/classCallCheck":14,"@babel/runtime/helpers/createClass":15,"@babel/runtime/helpers/interopRequireDefault":18,events:22}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TASK_PART_WHEN_EVENTS=void 0;r.TASK_PART_WHEN_EVENTS={END:"part.end",START:"part.start"}},{}],12:[function(e,t,r){"use strict";var n,a;Object.defineProperty(r,"__esModule",{value:!0}),r.TaskPartWhenOperator=void 0,r.TaskPartWhenOperator=n,(a=n||(r.TaskPartWhenOperator=n={}))[a.AND=0]="AND",a[a.OR=1]="OR"},{}],13:[function(e,t,r){t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},{}],14:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],15:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},{}],16:[function(e,t,r){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}t.exports=n},{}],17:[function(e,t,r){var n=e("./setPrototypeOf");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},{"./setPrototypeOf":20}],18:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],19:[function(e,t,r){var n=e("../helpers/typeof"),a=e("./assertThisInitialized");t.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?a(e):t}},{"../helpers/typeof":21,"./assertThisInitialized":13}],20:[function(e,r,t){function n(e,t){return r.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}r.exports=n},{}],21:[function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=a=function(e){return n(e)}:t.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(e)}t.exports=a},{}],22:[function(e,t,r){var u=Object.create||function(e){var t=function(){};return t.prototype=e,new t},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function n(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=u(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0;var a,o=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),a=0===l.x}catch(e){a=!1}function f(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var a,i,s;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=u(null),e._eventsCount=0),s){if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=f(e))&&0<a&&s.length>a){s.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=s.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",o.name,o.message)}}else s=i[t]=r,++e._eventsCount;return e}function p(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=i.call(p,n);return a.listener=r,n.wrapFn=a}function b(e,t,r){var n=e._events;if(!n)return[];var a=n[t];return a?"function"==typeof a?r?[a.listener||a]:[a]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(a):m(a,a.length):[]}function v(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function m(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}a?Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');o=e}}):n.defaultMaxListeners=o,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return f(this)},n.prototype.emit=function(e){var t,r,n,a,i,s,o="error"===e;if(s=this._events)o=o&&null==s.error;else if(!o)return!1;if(o){if(1<arguments.length&&(t=arguments[1]),t instanceof Error)throw t;var u=new Error('Unhandled "error" event. ('+t+")");throw u.context=t,u}if(!(r=s[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,a=m(e,n),i=0;i<n;++i)a[i].call(r)}(r,l,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=m(e,a),s=0;s<a;++s)i[s].call(r,n)}(r,l,this,arguments[1]);break;case 3:!function(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=m(e,i),o=0;o<i;++o)s[o].call(r,n,a)}(r,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,o=m(e,s),u=0;u<s;++u)o[u].call(r,n,a,i)}(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(n-1),i=1;i<n;i++)a[i-1]=arguments[i];!function(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=m(e,a),s=0;s<a;++s)i[s].apply(r,n)}(r,l,this,a)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){return c(this,e,t,!1)},n.prototype.prependListener=function(e,t){return c(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,h(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,h(this,e,t)),this},n.prototype.removeListener=function(e,t){var r,n,a,i,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=u(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,i=r.length-1;0<=i;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,a=i;break}if(a<0)return this;0===a?r.shift():function(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}(r,a),1===r.length&&(n[e]=r[0]),n.removeListener&&this.emit("removeListener",e,s||t)}return this},n.prototype.removeAllListeners=function(e){var t,r,n;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=u(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=u(null):delete r[e]),this;if(0===arguments.length){var a,i=s(r);for(n=0;n<i.length;++n)"removeListener"!==(a=i[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=u(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(n=t.length-1;0<=n;n--)this.removeListener(e,t[n]);return this},n.prototype.listeners=function(e){return b(this,e,!0)},n.prototype.rawListeners=function(e){return b(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},n.prototype.listenerCount=v,n.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}]},{},[2])(2)});